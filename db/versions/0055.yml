version: 55
description: add upload db fn to objects service
methods:
  upload_object:
    description: |-
      Upload object.
    mode: write
    serviceName: object
    args: name_in text, data_in jsonb, expires_in timestamptz
    returns: void
    body: |-
      begin
        insert
          into objects (name, data, expires)
          values (name_in, data_in, expires_in);
      end
  get_object:
    description: |-
      Get an object.
    mode: read
    serviceName: object
    args: name_in text
    returns: table (name text, data jsonb, expires timestamptz)
    body: |-
      begin
        return query select objects.name, objects.data, objects.expires from objects where objects.name = name_in;
      end
